<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Developer’s confession, building a custom passkey authenticator" /><meta property="og:locale" content="en" /><meta name="description" content="Intro" /><meta property="og:description" content="Intro" /><link rel="canonical" href="/posts/pitfalls-passkey/" /><meta property="og:url" content="/posts/pitfalls-passkey/" /><meta property="og:site_name" content="CyberSoup" /><meta property="og:image" content="/assets/img/2025/passkey/passkey_logo.jpeg" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2025-10-19T04:00:00+00:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="/assets/img/2025/passkey/passkey_logo.jpeg" /><meta property="twitter:title" content="Developer’s confession, building a custom passkey authenticator" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-12-01T08:41:23+00:00","datePublished":"2025-10-19T04:00:00+00:00","description":"Intro","headline":"Developer’s confession, building a custom passkey authenticator","image":"/assets/img/2025/passkey/passkey_logo.jpeg","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/pitfalls-passkey/"},"url":"/posts/pitfalls-passkey/"}</script><title>Developer's confession, building a custom passkey authenticator | CyberSoup</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="CyberSoup"><meta name="application-name" content="CyberSoup"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.2/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.27.20/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return 'mode'; } static get MODE_ATTR() { return 'data-mode'; } static get DARK_MODE() { return 'dark'; } static get LIGHT_MODE() { return 'light'; } static get ID() { return 'mode-toggle'; } constructor() { let self = this;this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { self.clearMode(); } self.notify(); }); if (!this.hasMode) { return; } if (this.isDarkMode) { this.setDark(); } else { this.setLight(); } } get sysDarkPrefers() { return window.matchMedia('(prefers-color-scheme: dark)'); } get isPreferDark() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); }get modeStatus() { if (this.hasMode) { return this.mode; } else { return this.isPreferDark ? ModeToggle.DARK_MODE : ModeToggle.LIGHT_MODE; } } setDark() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { document.documentElement.removeAttribute(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); }notify() { window.postMessage( { direction: ModeToggle.ID, message: this.modeStatus }, '*' ); } flipMode() { if (this.hasMode) { this.clearMode(); } else { if (this.isPreferDark) { this.setLight(); } else { this.setDark(); } } this.notify(); } } const modeToggle = new ModeToggle(); </script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/icon.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a><h1 class="site-title"> <a href="/">CyberSoup</a></h1><p class="site-subtitle fst-italic mb-0">Your tasty cyber security snack</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/cybersoup-org" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="javascript:location.href = 'mailto:' + ['cybersoupblog','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>Developer's confession, building a custom passkey authenticator</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1"><header><h1 data-toc-skip>Developer's confession, building a custom passkey authenticator</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1760846400" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Oct 19, 2025 </time> </span> <span> Updated <time data-ts="1764578483" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Dec 1, 2025 </time> </span><div class="mt-3 mb-3"> <a href="/assets/img/2025/passkey/passkey_logo.jpeg" class="popup img-link preview-img shimmer"><img src="/assets/img/2025/passkey/passkey_logo.jpeg" alt="Preview Image" width="1200" height="630" loading="lazy"></a></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://www.linkedin.com/in/michalkepkowski/">Michal Kepkowski</a> </em>, <em> <a href="https://www.linkedin.com/in/vijay-patil-a5634434/">Vijay Patil</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="2015 words" > <em>11 min</em> read</span></div></div></div></header><div class="content"><h2 id="intro"><span class="me-2">Intro</span><a href="#intro" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>I’ve been following the FIDO2 → passkeys story for a few years now. It started during my PhD, when I was digging into it as part of my research, and later continued at work, where I tried a few small real-world deployments—just enough to run into all the odd edge cases nobody talks about.</p><p>Along the way I’ve shared what I’ve learned, given a few talks, and yes, occasionally complained about how messy things can get when theory meets production. Still, I’m a big believer in the direction we’re heading: strong authentication that doesn’t make people’s lives harder.</p><p>Most recently, I got to take things a step further by building a custom mobile authenticator for an enterprise client. My colleague Vijay and I jumped in without a perfect plan, and (no surprise) the process was anything but linear. We hit a few dead ends, made some pivots, and had plenty of “let’s rethink this” moments. But that’s where the interesting lessons came from — and honestly, it was a lot of fun.</p><h2 id="a-chance"><span class="me-2">A Chance</span><a href="#a-chance" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The project kicked off with a fun challenge: bring passkeys into the mix as part of a shiny new biometric authentication initiative in the mobile app. Everything lived in the same ecosystem—accounts, the app, the identity provider—so at least the plumbing was all in one place.</p><p>At the time, the existing login flow was pretty classic: OpenID Connect (OIDC) authorization code flow, authentication with username, password and weak MFA (SMS or email OTP). Tokens of (BFF session) would then be tucked into device storage and happily reused for API calls. The obvious quick fix? Just let local biometrics unlock the mobile storage and get the tokens from there. The user experience is as expected: provide biometric and you are in. Job done, and everyone gets to go home early.</p><p>Even though from the user’s perspective, it feels like “biometric login,” and technically it does add some protection — if someone steals the phone, the tokens can’t be pulled without a fingerprint or face scan, that approach only helps protect the mobile storage. It doesn’t really improve the authentication itself. Users are still logging in with the same weak MFA, if tokens expire. It’s better than nothing, but it doesn’t move much the needle on the overall security model.</p><p>And since the long-term plan was to roll biometrics out to other enterprise applications including web logins, we knew we had to go further. So instead of stopping at “unlock the storage,” we aimed for the real win: using device biometrics as part of the passkey transaction. That way, biometrics actually are used to unlock private key that is used to create a valid authentication response.</p><p>To highlight the difference: in the first scenario, biometrics are only used to open the storage where a token or session is kept. They are never used in the actual authentication process with the remote server. In our desired approach, biometrics unlock the use of the private key that signs a challenge from the server. This transforms biometrics into a “something you are” factor in the cryprography-based authentication flow: passkey flow.</p><h2 id="the-plan"><span class="me-2">The Plan</span><a href="#the-plan" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Armed with a strong FIDO/Passkey background, eager developers, and a looming deadline, we figured: why not propose passkey as an authentication stage of the existing OIDC flow?</p><p>The idea was simple enough - extend the mobile application to act as a custom passkey authenticator, and trigger it via the WebAuthn API straight from the authentication page of our IDP. We dove into the Android and iOS documentation and quickly realized that we could leverage some of the newer SDK methods to build our authenticator. On Android, this comes through the <a href="https://developer.android.com/identity/sign-in/credential-provider">Credential Manager API from Android 14</a>. Similarly, <a href="https://developer.apple.com/documentation/authenticationservices/ascredentialproviderviewcontroller/prepareinterfacetoprovidecredential(for:)-68qpo">iOS 17+ Credential Provider</a> provided required functionality.</p><p>So in theory, it should have been a breeze: implement the interfaces, register the app as a passkey authenticator in the OS, and voilà — we’re done.</p><p>…Except, as you’ve probably guessed, it wasn’t quite that simple.</p><h2 id="pivots"><span class="me-2">Pivot(s)</span><a href="#pivots" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We started with Matthew’s <a href="https://webauthn.io/">webauthn.io</a> passkeys server, which let us test mobile behavior and SDKs without worrying about the backend. Once the flows felt solid, we planned to switch over to our own IdP server.</p><h3 id="hybrid-flow"><span class="me-2">Hybrid flow</span><a href="#hybrid-flow" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Even though the hybrid flow wasn’t a top priority for us, it was easy to set up, so we started testing custom authenticator behavior. Let’s quickly explain what the hybrid flow is. It’s a neat way to use your phone to run a passkey flow across devices. The typical scenario is starting authentication in your browser on a laptop, then handing control over to your mobile device to complete the passkey authentication. This process uses BLE and proximity mechanisms.</p><p>More information can be found on <a href="https://www.passkeycentral.org/design-guidelines/optional-patterns/cross-device-sign-in">Passkey Central</a>.</p><p>We started with Android, and to our surprise, we couldn’t see our authenticator. After a moment, we realized we might have a serious problem executing our plan — and it was right at the very first registration step. Definitely not a good sign.</p><h3 id="registration"><span class="me-2">Registration</span><a href="#registration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Our first hiccup came right at the registration stage. While the flow technically worked as expected (diagram below), we ran into a major UX issue.</p><pre><code class="language-mermaid">sequenceDiagram
    autonumber
    participant U as User using&lt;br&gt;Our Authenticator
    participant Browser
    participant IDP
    participant OS
    U -&gt;&gt; IDP: Start Flow on Desktop
    IDP -&gt;&gt; Browser: Authentication Page
    Browser-&gt;&gt;OS:WebAuthn API&lt;br&gt;navigator.credentials.create()&lt;br&gt;via QR code (hybrid flow)
    U-&gt;&gt;OS: Passkey Dialog
    OS-&gt;&gt;U: Create Credential
    U-&gt;&gt;OS: Registration Response
    OS-&gt;&gt;Browser: Registration Response
    Browser-&gt;&gt;IDP: Registration Response
</code></pre><p>When the WebAuthn API in JavaScript is triggered, Android opens its system dialog (step 4. in the diagram). The problem is that it displays all available providers, with the default one highlighted as preferred. To continue, we would have to either ask users to set our app as the default authenticator or guide them step by step on what to select — neither of which is acceptable. The recording below shows the problem.</p><p><a href="/../assets/img/2025/passkey/passkey_registration_custom.gif" class="popup img-link shimmer"><img src="/../assets/img/2025/passkey/passkey_registration_custom.gif" alt="Alt Text" loading="lazy"></a></p><p>Looking into the <a href="https://github.com/w3c/webauthn/issues/1688">WebAuthn Github</a>, we found this exact problem has been raised multiple times, but no solution is available yet.</p><h4 id="pivot-no-1"><span class="me-2">Pivot No. 1</span><a href="#pivot-no-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>In our case, however, the system controls the entire credential lifecycle — both the authenticator and the passkey server belong to the same entity. This allowed us to simplify registration by making it a direct REST call from the mobile app to the server, assuming the user has already onboarded to the app and has valid tokens. We showed this in the diagram below.</p><pre><code class="language-mermaid">sequenceDiagram
    autonumber
    participant U as User using&lt;br&gt;Our Authenticator
    participant Browser
    participant IDP
    participant OS
    U -&gt;&gt; IDP: Start Flow
    IDP -&gt;&gt; U: Challenge
    U-&gt;&gt;U: Create Credential
    U-&gt;&gt;IDP: Registration Response
</code></pre><p>It’s disappointing to step away from the standard OS-based flow, but we needed a working solution — so this is the path we took.</p><h3 id="custom-authenticator-with-mobile-flow"><span class="me-2">Custom Authenticator with mobile flow</span><a href="#custom-authenticator-with-mobile-flow" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>While running the hybrid flow, the authentication worked as expected. Our custom authenticator was queried to provide the available passkeys for the domain. If any was found, user was presented with this choice regardless if our authenticator was set as default. The same behaviour was observed when WebAuthn flow was triggered from Custom Chrome Tabs.</p><p><a href="/../assets/img/2025/passkey/passkey_chrome_tab_authn.gif" class="popup img-link shimmer"><img src="/../assets/img/2025/passkey/passkey_chrome_tab_authn.gif" alt="Alt Text" loading="lazy"></a></p><p>We felt a sense of relief, glad that our initial design wouldn’t need to be completely reworked into a non-native solution. Unfortunately, that relief was short-lived, as we soon ran into another challenge.</p><h3 id="legacy"><span class="me-2">Legacy</span><a href="#legacy" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Even if we could run passkey authentiction flow with the ChromeTabs mechanism, we faced another obstacle: OS versions without passkey support. From the SDKs, we know that the supported systems are Android 14+ and iOS 17+. The next step was to see how widespread those versions actually are. Looking at the <a href="https://gs.statcounter.com/android-version-market-share">Android versions market share</a>, we realized that Android 14 covers only about 50% of the market. As you can imagine, this isn’t something a client would likely accept. So what do we do for older OS versions?</p><p>We clearly needed to design a flow that delivers the same functionality for older devices while also not compromising security. By this point, we had already abandoned the OS-native registration flow. Now we were facing a new decision: should we also drop the OS-native passkey authentication flow? And if we do, what’s the point of relying on passkey-based authentication at all?</p><h4 id="pivot-no-2"><span class="me-2">Pivot No. 2</span><a href="#pivot-no-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Before we dive in the solution design, let’s organise requirements and limitations.</p><ol><li>We are in the mobile app which triggers OIDC-based flow in the native browser.<li>We cannot rely on WebAuthn API and mobile OS SDKs because of legacy OSes.<li>We want to keep the passkeys/FIDO2 protocol to be the core of our authentication flow. We want it to follow the standard with all its security properties. Additionally, we want to be compliant for the future, when hybrid flow for web applications can be used.</ol><p>So it is clear that our application as well as IDP server will remain passkey compliant. What we need is to modify how IDP server triggers passkey for the use cases we have. Instead of passing the passkey Request (i.e., PublicKeyCredentialRequestOptions in navigator.credentials.get()) in the JavaScript of the authentication page, we pass this through <a href="https://developer.android.com/training/app-links#android-app-links">applinks</a> and equivalend for iOS. This way the request will go directly to our custom authenticator application bypassing OS passkey layer. Then, the application submits passkey Response directly to IDP.</p><p>Great, technically it works. But let’s look at the security. Cryptography-wise everything remains the same. We only modified the transport mechanism. However, because of this, we broke the phishing resistant property of passkeys - pretty important one. Why is that? When the OS handles the passkey request, it gets the domain name from the calling browser, and then passes this information to authenticators to find the passkey that was registered for this domain. In our solution, this mechanism is bypassed so we need to address it somehow or accept as a risk.</p><p>Even though our application opens tabs with URLs fully controlled by us—pointing to our IdP and protected with all standard OIDC security mechanisms (such as nonce, state, and PKCE)—one could still imagine an attack vector where a user is redirected to a malicious man-in-the-middle (MITM) server that mimics our flow.</p><p>While this scenario primarily affects legacy operating systems and would require significant effort from an attacker, we decided to address it nonetheless. Unfortunately, Android App Links and iOS Universal Links triggered from within a browser do not expose the origin domain due to privacy protections. As a result, we cannot rely on app link data for domain verification. There are other mechanisms to capture the URL of ChromeTabs as listed in this <a href="https://hackernoon.com/retrieving-the-url-from-custom-tabs-in-android-ug263ueh">blog</a>, but they require additional user action which is not acceptable from UX perspective. We could use WebView instead and then we have total control over what is being done in the browser, and thus we could ensure that domain is correct. Switching to WebView, however, breaks SSO flows because cookie jar is not shared between application WebView and OS browser. Nevertheless, for this legacy OS case, it seems to be a reasonable compromise.</p><pre><code class="language-mermaid">sequenceDiagram
    autonumber
    participant U as User using&lt;br&gt;Our Authenticator
    participant B as Browser&lt;br&gt;(ChromeTabs)
    participant IDP
    participant OS
    U -&gt;&gt; B: Start Flow
    B -&gt;&gt; IDP: Start passkey for legacy
    IDP -&gt;&gt; IDP: This is applink flow
    IDP -&gt;&gt; U: Applink with&lt;br&gt;passkey request encoded
    note over U: Biometrics and&lt;br&gt;Passkey Authentication
    U -&gt;&gt; B: Redirect to IDP with passkey Response
    B -&gt;&gt; IDP: passkey Response
    note over IDP: Checks passkey Response
    IDP -&gt;&gt; B: Success
</code></pre><h2 id="summary"><span class="me-2">Summary</span><a href="#summary" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We started with passkey technology, but along the way, we realized that sticking strictly to OS-native flows wasn’t going to work smoothly in practice. So, we decided to take a different route.</p><p>The result is our custom mobile authenticator — it fully supports the passkey protocol but handles registration outside the native OS dialogs to avoid the user interface friction we encountered. For older operating systems, we added a fallback that uses a WebView with app-link-based redirections.</p><p>Because both the backend and the authenticator are under the same roof, we could make these integrations safely and efficiently. In the end, the authenticator is now ready for hybrid flow authentication and can also support other mobile apps that use passkey OS APIs.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/lessons-learned/">Lessons learned</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/passkey/" class="post-tag no-text-decoration" >Passkey</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://www.linkedin.com/sharing/share-offsite/?url=%2Fposts%2Fpitfalls-passkey%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <a href="https://twitter.com/intent/tweet?text=Developer's%20confession,%20building%20a%20custom%20passkey%20authenticator%20-%20CyberSoup&url=%2Fposts%2Fpitfalls-passkey%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fa-brands fa-square-x-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Developer's%20confession,%20building%20a%20custom%20passkey%20authenticator%20-%20CyberSoup&u=%2Fposts%2Fpitfalls-passkey%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/keycloak-selector/">Keycloak Selector - Easy Flow Design</a><li class="text-truncate lh-lg"> <a href="/posts/pitfalls-passkey/">Developer's confession, building a custom passkey authenticator</a><li class="text-truncate lh-lg"> <a href="/posts/WICYS-workshop/">WiCyS 2025 Workshop - Phishing Resistance of Passkeys</a><li class="text-truncate lh-lg"> <a href="/posts/secret-zero/">Keeping secrets secret</a><li class="text-truncate lh-lg"> <a href="/posts/GIAC-notes/">Cybersecurity - the longest journey</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/intermediate/">Intermediate</a> <a class="post-tag btn btn-outline-primary" href="/tags/wicys/">WiCyS</a> <a class="post-tag btn btn-outline-primary" href="/tags/appsec/">AppSec</a> <a class="post-tag btn btn-outline-primary" href="/tags/cissp/">CISSP</a> <a class="post-tag btn btn-outline-primary" href="/tags/giac/">GIAC</a> <a class="post-tag btn btn-outline-primary" href="/tags/keycloak/">Keycloak</a> <a class="post-tag btn btn-outline-primary" href="/tags/opa/">OPA</a> <a class="post-tag btn btn-outline-primary" href="/tags/passkey/">Passkey</a> <a class="post-tag btn btn-outline-primary" href="/tags/sans/">SANS</a></div></section></div><section id="toc-wrapper" class="d-none ps-0 pe-4"><h2 class="panel-heading ps-3 mb-2">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/GIAC-notes/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1734580800" data-df="ll" > Dec 19, 2024 </time><h4 class="pt-0 my-2">Cybersecurity - the longest journey</h4><div class="text-muted"><p>Part One: The Calling Ever since I joined the ranks of IT professionals, I’ve been constantly surprised by how patchy cybersecurity awareness is in some organizations. This unfortunately translate...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/WICYS-workshop/" class="btn btn-outline-primary" aria-label="Older" ><p>WiCyS 2025 Workshop - Phishing Resistance of Passkeys</p></a> <a href="/posts/keycloak-selector/" class="btn btn-outline-primary" aria-label="Newer" ><p>Keycloak Selector - Easy Flow Design</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2026</time> <a href="https://twitter.com/username">CyberSoup</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p></p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/intermediate/">Intermediate</a> <a class="post-tag btn btn-outline-primary" href="/tags/wicys/">WiCyS</a> <a class="post-tag btn btn-outline-primary" href="/tags/appsec/">AppSec</a> <a class="post-tag btn btn-outline-primary" href="/tags/cissp/">CISSP</a> <a class="post-tag btn btn-outline-primary" href="/tags/giac/">GIAC</a> <a class="post-tag btn btn-outline-primary" href="/tags/keycloak/">Keycloak</a> <a class="post-tag btn btn-outline-primary" href="/tags/opa/">OPA</a> <a class="post-tag btn btn-outline-primary" href="/tags/passkey/">Passkey</a> <a class="post-tag btn btn-outline-primary" href="/tags/sans/">SANS</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.11/dayjs.min.js,npm/dayjs@1.11.11/locale/en.min.js,npm/dayjs@1.11.11/plugin/relativeTime.min.js,npm/dayjs@1.11.11/plugin/localizedFormat.min.js,npm/tocbot@4.27.20/dist/tocbot.min.js,npm/mermaid@10.9.0/dist/mermaid.min.js"></script> <script src="/assets/js/dist/post.min.js"></script> <script src="/assets/js/data/mathjax.js"></script> <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script> <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-chtml.js"></script> <script type="text/javascript"> function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === 'undefined') { return; } let expectedTheme = mode === ModeToggle.DARK_MODE ? 'dark' : 'default'; let config = { theme: expectedTheme };const mermaidList = document.getElementsByClassName('mermaid'); [...mermaidList].forEach((elem) => { const svgCode = elem.previousSibling.children.item(0).innerHTML; elem.innerHTML = svgCode; elem.removeAttribute('data-processed'); }); mermaid.initialize(config); mermaid.init(undefined, '.mermaid'); } } (function () { let initTheme = 'default'; const html = document.documentElement; if ( (html.hasAttribute('data-mode') && html.getAttribute('data-mode') === 'dark') || (!html.hasAttribute('data-mode') && window.matchMedia('(prefers-color-scheme: dark)').matches) ) { initTheme = 'dark'; } let mermaidConf = { theme: initTheme};const basicList = document.getElementsByClassName('language-mermaid'); [...basicList].forEach((elem) => { const svgCode = elem.textContent; const backup = elem.parentElement; backup.classList.add('d-none');let mermaid = document.createElement('pre'); mermaid.classList.add('mermaid'); const text = document.createTextNode(svgCode); mermaid.appendChild(text); backup.after(mermaid); }); mermaid.initialize(mermaidConf); window.addEventListener('message', updateMermaid); })(); </script> <script defer src="/assets/js/dist/app.min.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-DG1HHNCFDD"></script> <script> document.addEventListener('DOMContentLoaded', function (event) { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-DG1HHNCFDD'); }); </script> <script>SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
